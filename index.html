<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal Selection Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
        }
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .day-title {
            font-size: 23px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #F20445;
        }
        .meal-title {
            font-size: 16px;
            font-weight: bold;
            color: white;
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            margin-top: 15px;
        }
        .meal-title.breakfast { background-color: #E8D917; }
        .meal-title.lunch { background-color: #F16B05; }
        .meal-title.dinner { background-color: #E80034; }
        .meal-title.snack { background-color: #F2049D; }
        .product-list {
            display: grid;
            gap: 15px;
            margin-top: 10px;
        }
        .product-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .quantity-controls button {
            padding: 5px 10px;
            font-size: 14px;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #ececec;
            border-radius: 4px;
        }
        .quantity-controls input {
            width: 50px;
            text-align: center;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .summary-section {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .summary-section h3 {
            font-size: 18px;
            font-weight: bold;
            color: #F20445;
        }
        #delivery-charge-summary {
            font-size: 16px;
            color: #333;
        }
        .total {
            font-size: 18px;
            font-weight: bold;
            color: #F20445;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        .inline-fields {
            display: flex;
            gap: 10px;
        }
        .inline-fields input {
            flex: 1;
        }
        .submit-button {
            background-color: #F20445;
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }
        .submit-button:hover {
            background-color: #E80034;
        }
        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #F20445;
            margin-bottom: 15px;
        }
        .separator {
            border-top: 2px solid #F20445;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <!-- Meal Selection Section -->
        <div id="meal-selection">
            <div class="separator"></div>
            <!-- Monday Delivery -->
            <div class="day-title">Monday Delivery</div>
            <div class="meal-title breakfast">Breakfast</div>
            <div class="product-list" id="Monday-Breakfast"></div>
            <div class="meal-title lunch">Lunch</div>
            <div class="product-list" id="Monday-Lunch"></div>
            <div class="meal-title dinner">Dinner</div>
            <div class="product-list" id="Monday-Dinner"></div>
            <div class="meal-title snack">Snack</div>
            <div class="product-list" id="Monday-Snack"></div>

            <div class="separator"></div>
            <!-- Wednesday Delivery -->
            <div class="day-title">Wednesday Delivery</div>
            <div class="meal-title breakfast">Breakfast</div>
            <div class="product-list" id="Wednesday-Breakfast"></div>
            <div class="meal-title lunch">Lunch</div>
            <div class="product-list" id="Wednesday-Lunch"></div>
            <div class="meal-title dinner">Dinner</div>
            <div class="product-list" id="Wednesday-Dinner"></div>
            <div class="meal-title snack">Snack</div>
            <div class="product-list" id="Wednesday-Snack"></div>

            <div class="separator"></div>
            <!-- Friday Delivery -->
            <div class="day-title">Friday Delivery</div>
            <div class="meal-title breakfast">Breakfast</div>
            <div class="product-list" id="Friday-Breakfast"></div>
            <div class="meal-title lunch">Lunch</div>
            <div class="product-list" id="Friday-Lunch"></div>
            <div class="meal-title dinner">Dinner</div>
            <div class="product-list" id="Friday-Dinner"></div>
            <div class="meal-title snack">Snack</div>
            <div class="product-list" id="Friday-Snack"></div>
        </div>

        <!-- Order Summary Section -->
        <div class="summary-section">
            <h3><b>Menu Summary</b></h3>
            <ul id="summary-list"></ul>
            <div id="delivery-charge-summary" style="display: none;">Delivery Charge: €10.00</div>
            <div class="total" id="grand-total">Total: €0.00</div>
        </div>

        <!-- Customer Details Section -->
        <div class="customer-details">
            <h3 class="section-title">Customer Details</h3>
            <div class="form-group">
                <input type="text" id="name" placeholder="Name" required>
            </div>
            <div class="form-group">
                <input type="email" id="email" placeholder="Email" required>
            </div>
            <div class="form-group">
                <input type="tel" id="phone" placeholder="Phone" required>
            </div>
            <div class="form-group">
                <textarea id="special-requests" placeholder="Special Requests (e.g., allergies)" required></textarea>
            </div>
        </div>

        <!-- Delivery Section (Optional) -->
        <div class="delivery-section">
            <h3 class="section-title">Delivery Details (Optional)</h3>
            <div class="form-group">
                <input type="text" id="street" placeholder="Street">
            </div>
            <div class="form-group inline-fields">
                <input type="text" id="city" placeholder="City">
                <input type="text" id="country" placeholder="Country">
                <input type="text" id="delivery-postcode" placeholder="Postcode">
            </div>
        </div>

        <!-- Submit Button -->
        <button class="submit-button" onclick="submitForm()">Submit my selection</button>
    </div>

    <script>
        // Product Data (You can update the product names here)
        const days = ['Monday', 'Wednesday', 'Friday'];
        const collections = ['Breakfast', 'Lunch', 'Dinner', 'Snack'];
        const prices = { Breakfast: 10, Lunch: 17, Dinner: 17, Snack: 10 };
        const products = [];

        // Populate products
        days.forEach(day => {
            collections.forEach(meal => {
                for (let i = 1; i <= 4; i++) {
                    products.push({
                        id: `${day}-${meal}-${i}`,
                        title: `${meal} Product ${i}`, // Update product names here
                        description: `Delicious ${meal} option`,
                        price: prices[meal],
                        day,
                        meal
                    });
                }
            });
        });

        // Function to populate meals
        function populateMeals() {
            products.forEach(product => {
                const productList = document.getElementById(`${product.day}-${product.meal}`);
                const productItem = document.createElement('div');
                productItem.classList.add('product-item');
                productItem.innerHTML = `
                    <input type="checkbox" data-id="${product.id}" data-price="${product.price}"> ${product.title} - ${product.description}
                    <div class="quantity-controls">
                        <button type="button" class="decrement" data-id="${product.id}">-</button>
                        <input type="number" value="1" min="1" max="10" data-id="${product.id}">
                        <button type="button" class="increment" data-id="${product.id}">+</button>
                        <span>€${product.price}</span>
                    </div>
                `;
                productList.appendChild(productItem);

                // Add event listeners for quantity controls
                productItem.querySelector('.decrement').addEventListener('click', event => {
                    const input = document.querySelector(`input[type='number'][data-id='${event.target.dataset.id}']`);
                    if (input.value > 1) input.value--;
                    updateSummary();
                });

                productItem.querySelector('.increment').addEventListener('click', event => {
                    const input = document.querySelector(`input[type='number'][data-id='${event.target.dataset.id}']`);
                    if (input.value < 10) input.value++;
                    updateSummary();
                });

                // Add event listener for checkbox changes
                productItem.querySelector('input[type="checkbox"]').addEventListener('change', updateSummary);
            });
        }

        // Function to update the order summary
        function updateSummary() {
            const summaryList = document.getElementById('summary-list');
            summaryList.innerHTML = '';
            let grandTotal = 0;
            let deliveryCharge = 0;

            // Collect selected items
            const mealChoices = [];
            products.forEach(product => {
                const checkbox = document.querySelector(`input[type='checkbox'][data-id='${product.id}']`);
                if (checkbox && checkbox.checked) {
                    const quantity = parseInt(document.querySelector(`input[type='number'][data-id='${product.id}']`).value);
                    const total = quantity * product.price;
                    grandTotal += total;

                    // Add to summary list
                    const summaryItem = document.createElement('li');
                    summaryItem.textContent = `${product.title} x${quantity} - €${total.toFixed(2)}`;
                    summaryList.appendChild(summaryItem);

                    // Add to meal choices for GHL form
                    mealChoices.push(`${product.title} x${quantity} - €${total.toFixed(2)}`);
                }
            });

            // Add delivery charge if applicable
            if (grandTotal < 30) {
                deliveryCharge = 10;
                document.getElementById('delivery-charge-summary').style.display = 'block';
                document.getElementById('delivery-charge-summary').textContent = `Delivery Charge: €${deliveryCharge.toFixed(2)}`;
            } else {
                document.getElementById('delivery-charge-summary').style.display = 'none';
            }

            // Update grand total
            grandTotal += deliveryCharge;
            document.getElementById('grand-total').textContent = `Total: €${grandTotal.toFixed(2)}`;
        }

        // Function to submit the form
        function submitForm() {
            // Collect customer details
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const specialRequests = document.getElementById('special-requests').value;

            // Collect delivery details (optional)
            const street = document.getElementById('street').value;
            const city = document.getElementById('city').value;
            const country = document.getElementById('country').value;
            const postcode = document.getElementById('delivery-postcode').value;

            // Collect selected meals and total amount
            const mealChoices = [];
            let grandTotal = 0;
            products.forEach(product => {
                const checkbox = document.querySelector(`input[type='checkbox'][data-id='${product.id}']`);
                if (checkbox && checkbox.checked) {
                    const quantity = parseInt(document.querySelector(`input[type='number'][data-id='${product.id}']`).value);
                    const total = quantity * product.price;
                    grandTotal += total;
                    mealChoices.push(`${product.title} x${quantity} - €${total.toFixed(2)}`);
                }
            });

            // Add delivery charge if applicable
            if (grandTotal < 30) {
                grandTotal += 10;
            }

            // Prepare the data to submit
            const formData = {
                name,
                email,
                phone,
                specialRequests,
                street,
                city,
                country,
                postcode,
                mealChoices: mealChoices.join('\n'),
                grandTotal: `€${grandTotal.toFixed(2)}`
            };

            // GHL API Endpoint and Headers
            const ghlApiUrl = 'https://rest.gohighlevel.com/v1/contacts/';
            const apiKey = 'YOUR_GHL_API_KEY'; // Replace with your actual API key
            const locationId = 'YOUR_LOCATION_ID'; // Replace with your actual location ID

            // Send data to GHL via API
            fetch(ghlApiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`,
                    'Version': '2021-07-28'
                },
                body: JSON.stringify({
                    locationId: locationId,
                    name: formData.name,
                    email: formData.email,
                    phone: formData.phone,
                    customFields: {
                        specialRequests: formData.specialRequests,
                        street: formData.street,
                        city: formData.city,
                        country: formData.country,
                        postcode: formData.postcode,
                        meal_choices: formData.mealChoices, // Custom field for meal choices
                        total_amount: formData.grandTotal // Custom field for total amount
                    }
                }),
            })
            .then(response => response.json())
            .then(data => {
                console.log('Success:', data);
                alert('Form submitted successfully!');
            })
            .catch((error) => {
                console.error('Error:', error);
                alert('An error occurred. Please try again.');
            });
        }

        // Populate meals on page load
        populateMeals();
    </script>
</body>
</html>
